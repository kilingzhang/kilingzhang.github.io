<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OpenTelemetry-æ•°æ®æº | kilingzhang</title>
<link rel="shortcut icon" href="https://blog.kilingzhang.com/favicon.ico?v=1669303767893">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://blog.kilingzhang.com/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="OpenTelemetry-æ•°æ®æº | kilingzhang - Atom Feed" href="https://blog.kilingzhang.com/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-193175920-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-193175920-1');
</script>


    <meta name="description" content="OpenTelemetry æ”¯æŒå¦‚ä¸‹æ‰€å®šä¹‰çš„å¤šä¸ªæ•°æ®æºã€‚æœªæ¥å¯èƒ½ä¼šæ·»åŠ æ›´å¤šçš„æ•°æ®æºã€‚
Traces
è¿½è¸ªå•ä¸ªè¯·æ±‚çš„è¿›ç¨‹ï¼Œç§°ä¸ºTraceï¼Œç”±ç»„æˆåº”ç”¨ç¨‹åºçš„æœåŠ¡å¤„ç†ã€‚è¯¥è¯·æ±‚å¯ä»¥ç”±ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºå‘èµ·ã€‚åˆ†å¸ƒå¼è¿½è¸ªæ˜¯ä¸€ç§è´¯ç©¿è¿›ç¨‹ã€ç½‘ç»œå’Œå®‰å…¨è¾¹ç•Œçš„ä¸€ç§..." />
    <meta name="keywords" content="å¯è§‚æµ‹å¹³å°,OpenTelemetry,Trace,Log,Metric" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://blog.kilingzhang.com">
  <img class="avatar" src="https://blog.kilingzhang.com/images/avatar.png?v=1669303767893" alt="">
  </a>
  <h1 class="site-title">
    kilingzhang
  </h1>
  <p class="site-description">
    ä¸€åªåœ¨å¥‹æ–—çš„å°é€æ˜ğŸˆ
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/kilingzhang" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              OpenTelemetry-æ•°æ®æº
            </h2>
            <div class="post-info">
              <span>
                2021-11-24
              </span>
              <span>
                14 min read
              </span>
              
                <a href="https://blog.kilingzhang.com/tag/XRE1Cdu84/" class="post-tag">
                  # å¯è§‚æµ‹å¹³å°
                </a>
              
                <a href="https://blog.kilingzhang.com/tag/HoJGn3sG7/" class="post-tag">
                  # OpenTelemetry
                </a>
              
                <a href="https://blog.kilingzhang.com/tag/HpFcFGqMVQ/" class="post-tag">
                  # Trace
                </a>
              
                <a href="https://blog.kilingzhang.com/tag/qIPl7iUdB9/" class="post-tag">
                  # Log
                </a>
              
                <a href="https://blog.kilingzhang.com/tag/t3EchIJ6th/" class="post-tag">
                  # Metric
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://tva2.sinaimg.cn/large/0064lX42ly1h8eh6f9pxhj30qo0f0t9k.jpg" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>OpenTelemetry æ”¯æŒå¦‚ä¸‹æ‰€å®šä¹‰çš„å¤šä¸ªæ•°æ®æºã€‚æœªæ¥å¯èƒ½ä¼šæ·»åŠ æ›´å¤šçš„æ•°æ®æºã€‚</p>
<h2 id="traces">Traces</h2>
<p>è¿½è¸ªå•ä¸ªè¯·æ±‚çš„è¿›ç¨‹ï¼Œç§°ä¸ºTraceï¼Œç”±ç»„æˆåº”ç”¨ç¨‹åºçš„æœåŠ¡å¤„ç†ã€‚è¯¥è¯·æ±‚å¯ä»¥ç”±ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºå‘èµ·ã€‚åˆ†å¸ƒå¼è¿½è¸ªæ˜¯ä¸€ç§è´¯ç©¿è¿›ç¨‹ã€ç½‘ç»œå’Œå®‰å…¨è¾¹ç•Œçš„ä¸€ç§è¿½è¸ªå½¢å¼ã€‚Traceä¸­çš„æ¯ä¸ªæœ€å°å·¥ä½œå•å…ƒç§°ä¸ºä¸€ä¸ªSpanã€‚æ¯ä¸ªTraceéƒ½æ˜¯æ˜¯ä¸€æ£µç”±Spanç»„æˆçš„æ ‘ç»“æ„ã€‚Spanæ˜¯ç”±è¯·æ±‚ä¸­é€šè¿‡ç³»ç»Ÿçš„æ‰€æ¶‰åŠçš„å„ä¸ªæœåŠ¡æˆ–ç»„ä»¶çš„å·¥ä½œå¯¹è±¡ã€‚æ¯ä¸ªSpanéƒ½åŒ…å«ä¸€ä¸ªä¸€ç»„å…¨å±€æƒŸä¸€æ ‡è¯†ç¬¦ï¼Œä»¥è¡¨ç¤ºæ¯ä¸ªSpanæ‰€å±çš„å”¯ä¸€è¯·æ±‚çš„Spanä¸Šä¸‹æ–‡ã€‚åŒæ—¶Spanæä¾›äº†è¯·æ±‚ã€é”™è¯¯å’ŒæŒç»­æ—¶é—´(RED)ç­‰æŒ‡æ ‡ï¼Œä»¥ä¾¿è°ƒè¯•å¯ç”¨æ€§å’Œæ€§èƒ½é—®é¢˜ã€‚</p>
<blockquote>
<p>Traces track the progression of a single request, called a trace, as it is handled by services that make up an application. The request may be initiated by a user or an application. Distributed tracing is a form of tracing that traverses process, network and security boundaries. Each unit of work in a trace is called a span; a trace is a tree of spans. Spans are objects that represent the work being done by individual services or components involved in a request as it flows through a system. A span contains a span context, which is a set of globally unique identifiers that represent the unique request that each span is a part of. A span provides Request, Error and Duration (RED) metrics that can be used to debug availability as well as performance issues.</p>
</blockquote>
<p>TraceåŒ…å«ä¸€ä¸ªå°è£…äº†æ•´ä¸ªè¯·æ±‚çš„ç«¯åˆ°ç«¯è€—æ—¶çš„æ ¹Spanã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªå•ä¸€çš„é€»è¾‘æ“ä½œï¼Œä¾‹å¦‚åœ¨ä¸€ä¸ªç½‘ç»œåº”ç”¨ç¨‹åºä¸­ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼ŒæŠŠä¸€ä¸ªäº§å“æ·»åŠ åˆ°ä¸€ä¸ªè´­ç‰©è½¦ä¸­ã€‚æ ¹Spanå°†æµ‹é‡ä»ç»ˆç«¯ç”¨æˆ·ç‚¹å‡»è¯¥æŒ‰é’®åˆ°æ“ä½œå®Œæˆæˆ–å¤±è´¥ï¼ˆé¡¹ç›®è¢«æ·»åŠ åˆ°è´­ç‰©è½¦æˆ–å‘ç”Ÿä¸€äº›é”™è¯¯ï¼‰å¹¶å‘ç”¨æˆ·æ˜¾ç¤ºç»“æœæ‰€éœ€çš„æ—¶é—´ã€‚ä¸€ä¸ªè¿½è¸ªæ˜¯ç”±å•ä¸€çš„æ ¹Spanå’Œä»»ä½•æ•°é‡çš„å­Spanç»„æˆçš„ï¼Œå­Spanè¡¨ç¤ºä½œä¸ºè¯·æ±‚çš„ä¸€éƒ¨åˆ†æ‰€å‘ç”Ÿçš„æ“ä½œã€‚æ¯ä¸ªSpanéƒ½åŒ…å«å…³äºæ“ä½œçš„å…ƒæ•°æ®ï¼Œå¦‚ï¼šåç§°ã€å¼€å§‹å’Œç»“æŸçš„æ—¶é—´æˆ³ã€å±æ€§ã€äº‹ä»¶å’ŒçŠ¶æ€ã€‚</p>
<blockquote>
<p>A trace contains a single root span which encapsulates the end-to-end latency for the entire request. You can think of this as a single logical operation, such as clicking a button in a web application to add a product to a shopping cart. The root span would measure the time it took from an end-user clicking that button to the operation being completed or failing (so, the item is added to the cart or some error occurs) and the result being displayed to the user. A trace is comprised of the single root span and any number of child spans, which represent operations taking place as part of the request. Each span contains metadata about the operation, such as its name, start and end timestamps, attributes, events, and status.</p>
</blockquote>
<p>ä¸ºäº†åœ¨OpenTelemetryä¸­åˆ›å»ºå’Œç®¡ç†Spanï¼ŒOpenTelemetry APIæä¾›äº†Traceæ¥å£ã€‚è¯¥å¯¹è±¡è´Ÿè´£è¿½è¸ªè¿›ç¨‹ä¸­çš„è¿è¡Œçš„Spanï¼Œå¹¶å…è®¸ä½ è®¿é—®å½“å‰Spanï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œæ“ä½œï¼Œå¦‚æ·»åŠ å±æ€§ã€äº‹ä»¶ï¼Œä»¥åŠåœ¨å…¶è¿½è¸ªçš„å·¥ä½œå®Œæˆåç»“æŸå®ƒã€‚ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥é€šè¿‡ã€Œ Tracer Providerã€ åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªTraceå¯¹è±¡ï¼Œè¿™ä¸ªå·¥å‚æ¥å£å…è®¸åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ç”¨ä¸åŒçš„é€‰é¡¹å®ä¾‹åŒ–å¤šä¸ªTraceã€‚</p>
<blockquote>
<p>To create and manage spans in OpenTelemetry, the OpenTelemetry API provides the tracer interface. This object is responsible for tracking the active span in your process, and allows you to access the current span in order to perform operations on it such as adding attributes, events, and finishing it when the work it tracks is complete. One or more tracer objects can be created in a process through the tracer provider, a factory interface that allows for multiple tracers to be instantiated in a single process with different options.</p>
</blockquote>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªSpançš„ç”Ÿå‘½å‘¨æœŸç±»ä¼¼å¦‚ä¸‹:</p>
<ul>
<li>ä¸€ä¸ªæœåŠ¡æ”¶åˆ°äº†ä¸€ä¸ªè¯·æ±‚ã€‚å¦‚æœå­˜åœ¨Spanä¸Šä¸‹æ–‡ï¼Œåˆ™ä»è¯·æ±‚å¤´ä¸­æå–ä¸Šä¸‹æ–‡ã€‚</li>
<li>ä¸€ä¸ªæ–°çš„Spanè¢«åˆ›å»ºä¸ºä»Headeræå–çš„Spanä¸Šä¸‹æ–‡çš„å­çº§ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„æ ¹Spanã€‚</li>
<li>æ¯ä¸ªæœåŠ¡å¤„ç†çš„è¯·æ±‚ã€‚é¢å¤–çš„å±æ€§å’Œäº‹ä»¶å°†è¢«æ·»åŠ åˆ°Spanä¸­ï¼Œè¿™äº›å±æ€§å’Œäº‹ä»¶å¯¹äºç†è§£è¯·æ±‚çš„ä¸Šä¸‹æ–‡æ˜¯æœ‰ç”¨çš„ï¼Œä¾‹å¦‚å¤„ç†è¯·æ±‚çš„æœºå™¨çš„ä¸»æœºåï¼Œæˆ–è€…å®¢æˆ·æ ‡è¯†ç¬¦ç­‰ã€‚</li>
<li>å¯ä»¥åˆ›å»ºæ–°çš„è·¨åº¦æ¥ä»£è¡¨æœåŠ¡çš„å­ç»„ä»¶æ‰€æ­£åœ¨è¿›è¡Œçš„å·¥ä½œã€‚</li>
<li>å½“æœåŠ¡å¯¹å¦ä¸€ä¸ªæœåŠ¡è¿›è¡Œè¿œç¨‹è°ƒç”¨æ—¶ï¼Œå½“å‰çš„è·¨åº¦ä¸Šä¸‹æ–‡å°†è¢«åºåˆ—åŒ–ï¼Œå¹¶é€šè¿‡å°†è·¨åº¦çš„ä¸Šä¸‹æ–‡æ³¨å…¥è¯·æ±‚å¤´æˆ–æ¶ˆæ¯åŒ…çš„æ–¹å¼è½¬å‘ç»™ä¸‹ä¸€ä¸ªæœåŠ¡ã€‚</li>
<li>æœåŠ¡æ‰€åšçš„å·¥ä½œå®Œæˆäº†ï¼Œæ— è®ºæˆåŠŸä¸å¦ã€‚è·¨åº¦çŠ¶æ€åº”è¯¥è¢«é€‚å½“åœ°è®¾ç½®ï¼Œå¹¶ä¸”å°†è·¨åº¦æ ‡è®°ä¸ºå®Œæˆã€‚</li>
</ul>
<p>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://opentelemetry.io/docs/reference/specification/overview/#tracing-signal">è¿½è¸ªè§„èŒƒ</a></p>
<blockquote>
<ul>
<li>A request is received by a service. The span context is extracted from the request headers, if it exists.</li>
<li>A new span is created as a child of the extracted span context; if none exists, a new root span is created.</li>
<li>The service handles the request. Additional attributes and events are added to the span that are useful for understanding the context of the request, such as the hostname of the machine handling the request, or customer identifiers.</li>
<li>New spans may be created to represent work being done by sub-components of the service.</li>
<li>When the service makes a remote call to another service, the current span context is serialized and forwarded to the next service by injecting the span context into the headers or message envelope.</li>
<li>The work being done by the service completes, successfully or not. The span status is appropriately set, and the span is marked finished.</li>
</ul>
</blockquote>
<h2 id="metrics">Metrics</h2>
<p>Metrics æ˜¯å…³äºæœåŠ¡åœ¨è¿è¡Œæ—¶æ•è·çš„æµ‹é‡ç»“æœã€‚ä»é€»è¾‘ä¸Šè®²ï¼Œæ•è·å…¶ä¸­ä¸€ä¸ªåº¦é‡çš„æ—¶åˆ»è¢«ç§°ä¸ºåº¦é‡äº‹ä»¶ï¼Œå®ƒä¸ä»…åŒ…æ‹¬åº¦é‡æœ¬èº«ï¼Œè¿˜åŒ…æ‹¬æ•è·å®ƒçš„æ—¶é—´å’Œç›¸å…³çš„å…ƒæ•°æ®ã€‚</p>
<p>åº”ç”¨ç¨‹åºå’Œè¯·æ±‚åº¦é‡æ˜¯å¯ç”¨æ€§å’Œæ€§èƒ½çš„é‡è¦æŒ‡æ ‡ã€‚è‡ªå®šä¹‰æŒ‡æ ‡å¯ä»¥æ·±å…¥äº†è§£å¯ç”¨æ€§æŒ‡æ ‡å¦‚ä½•å½±å“ç”¨æˆ·ä½“éªŒæˆ–ä¸šåŠ¡ã€‚æ”¶é›†åˆ°çš„æ•°æ®å¯ç”¨äºè­¦å‘Šåœæœºæˆ–è§¦å‘è°ƒåº¦å†³ç­–ï¼Œä»¥ä¾¿åœ¨éœ€æ±‚é«˜æ—¶è‡ªåŠ¨æ‰©å±•éƒ¨ç½²ã€‚</p>
<p>å¦‚ä»Šï¼ŒOpenTelemetry å®šä¹‰äº†ä¸‰ç§åº¦é‡å·¥å…·:</p>
<ul>
<li>è®¡æ•°å™¨ã€ŒCounterã€: ä¸€ä¸ªéšæ—¶é—´ç´¯åŠ çš„å€¼ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆæ±½è½¦ä¸Šçš„é‡Œç¨‹è¡¨ï¼Œå®ƒåªä¼šå¢åŠ ã€‚</li>
<li>åº¦é‡ã€ŒMeasureã€: éšç€æ—¶é—´çš„æ¨ç§»è€Œèšåˆçš„å€¼ã€‚è¿™æ›´ç±»ä¼¼äºæ±½è½¦ä¸Šçš„è¡Œç¨‹é‡Œç¨‹è¡¨ï¼Œå®ƒè¡¨ç¤ºæŸä¸ªå®šä¹‰èŒƒå›´å†…çš„å€¼ã€‚</li>
<li>è§‚æµ‹å™¨ã€ŒObserverã€: æ•æ‰å½“å‰æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹çš„ä¸€ç»„æ•°å€¼ï¼Œå¦‚æ±½è½¦ä¸­çš„ç‡ƒæ²¹è¡¨ã€‚</li>
</ul>
<p>é™¤äº†è¿™ä¸‰ç§å…¬åˆ¶å·¥å…·ä¹‹å¤–ï¼Œèšåˆã€Œaggregationsã€çš„æ¦‚å¿µä¹Ÿæ˜¯éœ€è¦ç†è§£çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µã€‚èšåˆæ˜¯ä¸€ç§æŠ€æœ¯ï¼Œé€šè¿‡è¿™ç§æŠ€æœ¯ï¼Œå¯ä»¥å°†å¤§é‡åº¦é‡ç»„åˆæˆå…³äºåœ¨ä¸€ä¸ªæ—¶é—´çª—å£å†…å‘ç”Ÿçš„åº¦é‡äº‹ä»¶çš„ç¡®åˆ‡æˆ–ä¼°è®¡ç»Ÿè®¡ä¿¡æ¯ã€‚OpenTelemetry api æœ¬èº«ä¸å…è®¸æ‚¨æŒ‡å®šè¿™äº›èšåˆï¼Œä½†æ˜¯å´æä¾›äº†ä¸€äº›é»˜è®¤å€¼ã€‚é€šå¸¸ï¼ŒOpenTelemetry sdk æä¾›äº†å¯è§†åŒ–å·¥å…·å’Œé¥æµ‹åç«¯æ”¯æŒçš„å¸¸è§èšåˆ(å¦‚ sumã€ countã€ last value å’Œ histogram)ã€‚</p>
<p>è¯·æ±‚è·Ÿè¸ªçš„ç›®çš„æ˜¯æ•è·è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸ºè¯·æ±‚çš„å„ä¸ªéƒ¨åˆ†æä¾›ä¸Šä¸‹æ–‡ï¼Œè€Œåº¦é‡çš„ç›®çš„æ˜¯æä¾›æ€»ä½“çš„ç»Ÿè®¡ä¿¡æ¯ã€‚æ ‡å‡†åº¦é‡çš„ä¸€äº›ç”¨ä¾‹åŒ…æ‹¬:</p>
<ul>
<li>æŠ¥å‘Šæ¯ä¸ªåè®®ç±»å‹çš„æœåŠ¡è¯»å–çš„å­—èŠ‚æ€»æ•°</li>
<li>æŠ¥å‘Šæ¯ä¸ªè¯·æ±‚çš„è¯»å–æ€»å­—èŠ‚æ•°å’Œå­—èŠ‚æ•°</li>
<li>æŠ¥å‘Šç³»ç»Ÿè°ƒç”¨çš„æŒç»­æ—¶é—´</li>
<li>æŠ¥å‘Šè¯·æ±‚å¤§å°ä»¥ç¡®å®šè¶‹åŠ¿</li>
<li>æŠ¥å‘Šè¿›ç¨‹çš„CPUæˆ–å†…å­˜ä½¿ç”¨æƒ…å†µ</li>
<li>æŠ¥å‘Šå¸æˆ·çš„å¹³å‡ä½™é¢</li>
<li>æŠ¥å‘Šå½“å‰æ´»åŠ¨æ­£åœ¨å¤„ç†çš„è¯·æ±‚</li>
</ul>
<p>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚<a href="https://opentelemetry.io/docs/reference/specification/overview/#metric-signal">é˜…åº¦é‡è§„èŒƒ</a></p>
<blockquote>
<p>A metric is a measurement about a service, captured at runtime. Logically, the moment of capturing one of these measurements is known as a metric event which consists not only of the measurement itself, but the time that it was captured and associated metadata.</p>
</blockquote>
<blockquote>
<p>Application and request metrics are important indicators of availability and performance. Custom metrics can provide insights into how availability indicators impact user experience or the business. Collected data can be used to alert of an outage or trigger scheduling decisions to scale up a deployment automatically upon high demand.</p>
</blockquote>
<blockquote>
<p>OpenTelemetry defines three metric instruments today:</p>
</blockquote>
<blockquote>
<ul>
<li>counter: a value that is summed over time â€“ you can think of this like an odometer on a car; it only ever goes up.</li>
<li>measure: a value that is aggregated over time. This is more akin to the trip odometer on a car, it represents a value over some defined range.</li>
<li>observer: captures a current set of values at a particular point in time, like a fuel gauge in a vehicle.</li>
</ul>
</blockquote>
<blockquote>
<p>In addition to the three metric instruments, the concept of aggregations is an important one to understand. An aggregation is a technique whereby a large number of measurements are combined into either exact or estimated statistics about metric events that took place during a time window. The OpenTelemetry API itself does not allow you to specify these aggregations, but provides some default ones. In general, the OpenTelemetry SDK provides for common aggregations (such as sum, count, last value, and histograms) that are supported by visualizers and telemetry backends.</p>
</blockquote>
<blockquote>
<p>Unlike request tracing, which is intended to capture request lifecycles and provide context to the individual pieces of a request, metrics are intended to provide statistical information in aggregate. Some examples of use cases for metrics include:</p>
</blockquote>
<blockquote>
<ul>
<li>Reporting the total number of bytes read by a service, per protocol type.</li>
<li>Reporting the total number of bytes read and the bytes per request.</li>
<li>Reporting the duration of a system call.</li>
<li>Reporting request sizes in order to determine a trend.</li>
<li>Reporting CPU or memory usage of a process.</li>
<li>Reporting average balance values from an account.</li>
<li>Reporting current active requests being handled.</li>
</ul>
</blockquote>
<blockquote>
<p>For more information, see the metrics specification, which covers topics including: measure, measurement, metric, data, data point and labels.</p>
</blockquote>
<h2 id="logs">Logs</h2>
<p>æ—¥å¿—æ˜¯æœ‰å…ƒæ•°æ®çš„å¸¦æ—¶é—´æˆ³çš„æ–‡æœ¬è®°å½•ï¼Œå¯ä»¥æ˜¯ç»“æ„åŒ–(å»ºè®®)çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éç»“æ„åŒ–çš„ã€‚è™½ç„¶æ—¥å¿—æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®æºï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥é™„åŠ åˆ° Spanã€‚åœ¨ OpenTelemetry ä¸­ï¼Œä»»ä½•ä¸å±äºåˆ†å¸ƒå¼è¿½è¸ªå’Œåº¦é‡çš„æ•°æ®éƒ½æ˜¯æ—¥å¿—ã€‚ä¾‹å¦‚ï¼Œäº‹ä»¶å°±æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„æ—¥å¿—ã€‚æ—¥å¿—é€šå¸¸ç”¨äºç¡®å®šé—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œé€šå¸¸åŒ…å«å…³äºè°æ›´æ”¹äº†ä»€ä¹ˆä»¥åŠæ›´æ”¹çš„ç»“æœçš„ä¿¡æ¯ã€‚</p>
<p>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://opentelemetry.io/docs/reference/specification/overview/#log-signal">æ—¥å¿—è§„èŒƒ</a></p>
<blockquote>
<p>A log is a timestamped text record, either structured (recommended) or unstructured, with metadata. While logs are an independent data source, they may also be attached to spans. In OpenTelemetry, any data that is not part of a distributed trace or a metric is a log. For example, events are a specific type of log. Logs are often used to determine the root cause of an issue and typically contain information about who changed what as well as the result of the change.</p>
</blockquote>
<blockquote>
<p>For more information, see the logs specification, which covers topics including: log, defined fields, trace context fields and severity fields.</p>
</blockquote>
<h2 id="baggage">Baggage</h2>
<p>é™¤äº†è¿½è¸ªä¼ æ’­ä¹‹å¤–ï¼ŒOpenTelemetry è¿˜æä¾›äº†ä¸€ç§ç®€å•çš„å k/vå¯¹çš„ä¼ æ’­æœºåˆ¶ï¼Œç§°ä¸ºè¡Œæã€Œ baggageã€ã€‚ ã€Œbaggageã€æ—¨åœ¨åœ¨ä¸€ä¸ªæœåŠ¡ä¸­ç´¢å¼•å¯è§‚å¯Ÿæ€§äº‹ä»¶ï¼Œè¯¥æœåŠ¡åœ¨åŒä¸€äº‹åŠ¡ä¸­çš„å…ˆå‰æœåŠ¡æä¾›çš„å±æ€§ã€‚è¿™æœ‰åŠ©äºåœ¨è¿™äº›äº‹ä»¶ä¹‹é—´å»ºç«‹å› æœå…³ç³»ã€‚</p>
<p>è™½ç„¶ã€Œbaggageã€å¯ä»¥ç”¨æ¥æ„å…¶ä»–çº¬åº¦å…³æ³¨ç‚¹çš„åŸå‹ï¼Œä½†è¿™ç§æœºåˆ¶ä¸»è¦ç”¨äºä¼ é€’ OpenTelemetry å¯è§‚æµ‹æ€§ç³»ç»Ÿçš„å€¼ã€‚</p>
<p>è¿™äº›å€¼å¯ä»¥ä»ã€Œbaggageã€ä¸­ä½¿ç”¨ï¼Œå¹¶ç”¨ä½œåº¦é‡çš„é¢å¤–ç»´åº¦ï¼Œæˆ–ç”¨ä½œæ—¥å¿—å’Œè¿½è¸ªçš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­:</p>
<ul>
<li>WebæœåŠ¡å¯ä»¥é€šè¿‡åŒ…å«å‘é€è¯·æ±‚çš„æœåŠ¡çš„ä¸Šä¸‹æ–‡</li>
<li>SaaSæä¾›å•†å¯ä»¥åŒ…æ‹¬å…³äºè´Ÿè´£è¯¥è¯·æ±‚çš„APIç”¨æˆ·æˆ–ä»¤ç‰Œçš„ä¸Šä¸‹æ–‡</li>
<li>ç¡®å®šä¸€ä¸ªç‰¹å®šçš„æµè§ˆå™¨ç‰ˆæœ¬ä¸å›¾åƒå¤„ç†æœåŠ¡ä¸­çš„æ•…éšœæœ‰å…³</li>
</ul>
<p>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://opentelemetry.io/docs/reference/specification/overview/#baggage-signal">è¡Œæè§„èŒƒ</a></p>
<blockquote>
<p>In addition to trace propagation, OpenTelemetry provides a simple mechanism for propagating name/value pairs, called baggage. Baggage is intended for indexing observability events in one service with attributes provided by a prior service in the same transaction. This helps to establish a causal relationship between these events.</p>
</blockquote>
<blockquote>
<p>While baggage can be used to prototype other cross-cutting concerns, this mechanism is primarily intended to convey values for the OpenTelemetry observability systems.</p>
</blockquote>
<blockquote>
<p>These values can be consumed from baggage and used as additional dimensions for metrics, or additional context for logs and traces. Some examples:</p>
</blockquote>
<blockquote>
<ul>
<li>A web service can benefit from including context around what service has sent the request</li>
<li>A SaaS provider can include context about the API user or token that is responsible for that request</li>
<li>Determining that a particular browser version is associated with a failure in an image processing service</li>
</ul>
</blockquote>
<blockquote>
<p>For more information, see the baggage specification.</p>
</blockquote>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#traces">Traces</a></li>
<li><a href="#metrics">Metrics</a></li>
<li><a href="#logs">Logs</a></li>
<li><a href="#baggage">Baggage</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://blog.kilingzhang.com/post/opentelemetry-zu-jian/">
              <h3 class="post-title">
                OpenTelemetry-ç»„ä»¶
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '80dc14b8b39a9a9b7148',
    clientSecret: 'e50fadaa8a0908b977c1763e1ceb3b0b77727207',
    repo: 'Gittalk',
    owner: 'kilingzhang',
    admin: ['kilingzhang'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  <a href="https://github.com/kilingzhang" target="_blank">kilingzhang</a>
  <a class="rss" href="https://blog.kilingzhang.com/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
